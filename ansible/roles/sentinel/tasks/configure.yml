# Configure sentinel application
---

- name: Deploy application.yml
  ansible.builtin.template:
    src: application.yml.j2
    dest: "{{ sentinel_config_dir }}/application.yml"
    owner: "{{ sentinel_user }}"
    group: "{{ sentinel_group }}"
    mode: "0600"
  notify: Restart sentinel

- name: Deploy environment file
  ansible.builtin.template:
    src: sentinel.env.j2
    dest: "{{ sentinel_config_dir }}/sentinel.env"
    owner: "{{ sentinel_user }}"
    group: "{{ sentinel_group }}"
    mode: "0600"
  notify: Restart sentinel

- name: Deploy logback configuration
  ansible.builtin.template:
    src: logback-spring.xml.j2
    dest: "{{ sentinel_config_dir }}/logback-spring.xml"
    owner: "{{ sentinel_user }}"
    group: "{{ sentinel_group }}"
    mode: "0640"
  notify: Restart sentinel

- name: Configure log rotation
  ansible.builtin.template:
    src: sentinel-logrotate.j2
    dest: /etc/logrotate.d/sentinel
    owner: root
    group: root
    mode: "0644"
