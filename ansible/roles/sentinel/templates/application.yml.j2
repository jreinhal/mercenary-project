# SENTINEL Application Configuration
# Generated by Ansible - DO NOT EDIT MANUALLY
# Environment: {{ environment_name }}
# Edition: {{ sentinel_edition }}
# Generated: {{ ansible_date_time.iso8601 }}

server:
  port: {{ sentinel_port }}
  address: {{ sentinel_host }}
{% if enable_tls %}
  ssl:
    enabled: true
    key-store: {{ tls_keystore_path }}
    key-store-password: {{ tls_keystore_password }}
    key-store-type: PKCS12
    key-alias: sentinel
{% endif %}

spring:
  profiles:
    active: {{ spring_profiles | join(',') }}

  data:
    mongodb:
      uri: {{ mongodb_uri }}
      database: {{ mongodb_database }}
{% if mongodb_user is defined and vault_mongodb_password is defined %}
      username: {{ mongodb_user }}
      password: {{ vault_mongodb_password }}
{% endif %}

  ai:
    ollama:
      base-url: {{ ollama_base_url }}
      chat:
        model: {{ ollama_model }}
      embedding:
        model: {{ ollama_embedding_model }}

sentinel:
  edition: {{ sentinel_edition }}

  security:
    auth-mode: {{ auth_mode }}
{% if auth_mode == 'STANDARD' %}
    admin-password: {{ admin_password }}
{% endif %}
    jwt-secret: {{ jwt_secret }}
    encryption-key: {{ encryption_key }}
    rate-limit:
      enabled: {{ rate_limit_enabled | lower }}
      requests-per-minute: {{ rate_limit_requests_per_minute }}
{% if cac_auth_enabled | default(false) %}
    cac:
      enabled: true
      trust-store: {{ sentinel_config_dir }}/tls/truststore.p12
{% endif %}

  audit:
    enabled: {{ audit_enabled | lower }}
    fail-closed: {{ audit_fail_closed | default(false) | lower }}
    log-path: {{ audit_log_path }}

  features:
    feedback: {{ feedback_enabled | lower }}
    graph-visualization: {{ graph_visualization_enabled | lower }}
    pii-redaction: {{ pii_redaction_enabled | lower }}

{% if sentinel_edition == 'government' %}
  clearance:
    max-level: {{ max_clearance_level | default('TOP_SECRET') }}
    default-level: {{ default_clearance_level | default('SECRET') }}
{% endif %}

logging:
  level:
    root: {{ 'DEBUG' if debug_mode | default(false) else 'INFO' }}
    com.jreinhal.mercenary: {{ 'DEBUG' if debug_mode | default(false) else 'INFO' }}
  file:
    path: {{ sentinel_log_dir }}

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when-authorized
