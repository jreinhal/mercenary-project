spring:
  application:
    name: mercenary-ai
  profiles:
    active: ${APP_PROFILE:dev}

  # --- THE BAN HAMMER ---
  # This tells Spring: "Do NOT load your default MongoDB Vector Store logic. I have my own."
  autoconfigure:
    exclude: org.springframework.ai.autoconfigure.vectorstore.mongo.MongoDBAtlasVectorStoreAutoConfiguration

  data:
    mongodb:
      # SECURE DEFAULT: Localhost (No Auth)
      # PRODUCTION GUIDANCE: Overwrite MONGODB_URI env var with secure connection string
      uri: ${MONGODB_URI:mongodb://localhost:27017/mercenary}
  servlet:
    multipart:
      max-file-size: 50MB
      max-request-size: 50MB
  ai:
    ollama:
      base-url: ${OLLAMA_URL:http://localhost:11434}
      chat:
        options:
          model: ${LLM_MODEL:llama3}
          temperature: 0.7
      embedding:
        model: ${EMBEDDING_MODEL:nomic-embed-text}
    vectorstore:
      mongodb:
        atlas:
          collection-name: vector_store
          initialize-schema: false
          path-name: embedding
          index-name: vector_index

# ============================================
# Custom App Config
# ============================================
app:
  db-init: true
  # Authentication mode: DEV, OIDC, or CAC
  auth-mode: ${AUTH_MODE:DEV}

# ============================================
# Profile-specific configurations
# ============================================

---
# DEVELOPMENT PROFILE (default)
spring:
  config:
    activate:
      on-profile: dev

app:
  auth-mode: DEV

---
# ENTERPRISE PROFILE (Azure AD / Okta)
spring:
  config:
    activate:
      on-profile: enterprise

app:
  auth-mode: OIDC
  oidc:
    issuer: ${OIDC_ISSUER}
    client-id: ${OIDC_CLIENT_ID}

---
# GOVERNMENT/GOVCLOUD PROFILE (CAC/PIV)
spring:
  config:
    activate:
      on-profile: govcloud

app:
  auth-mode: CAC

# For air-gapped deployments, override MongoDB URI:
# MONGODB_URI=mongodb://localhost:27017/mercenary